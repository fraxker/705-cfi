# 705-cfi
Repo for CSC 705 paper reproducibility findings for "Control Flow Integrity for COTS Binaries"

Dependencies:

This paper has two major libraries it uses
- [Capstone](http://www.capstone-engine.org/) which can be installed from pypi
- [Captools](https://github.com/alexander-hanel/capstool) which the python3 version of must be cloned and installed from source

Running:

The code can be executed with the following command
```sh
python3 cfi_dis.py
```

Example findings:

```
Linear Disassembly instructions: [(0, 2, 'jg', '0x47'), (2, 4, 'add', 'r8b, byte ptr [rcx]'), (6, 2, 'add', 'dword ptr [rax], eax'), (8, 2, 'add', 'byte ptr [rax], al'), (10, 2, 'add', 'byte ptr [rax], al'), (12, 2, 'add', 'byte ptr [rax], al'), (14, 2, 'add', 'byte ptr [rax], al'), (16, 2, 'add', 'eax, dword ptr [rax]'), (18, 3, 'add', 'byte ptr ds:[rcx], al'), (21, 2, 'add', 'byte ptr [rax], al'), (23, 2, 'add', 'al, ah'), (25, 3, 'add', 'dword ptr ss:[rax], eax'), (28, 2, 'add', 'byte ptr [rax], al'), (30, 2, 'add', 'byte ptr [rax], al'), (32, 3, 'add', 'byte ptr [rax], al'), (35, 2, 'add', 'byte ptr [rax], al'), (37, 2, 'add', 'byte ptr [rax], al'), (39, 3, 'add', 'byte ptr [rax - 0x1c], ch'), (42, 2, 'or', 'al, 0'), (44, 2, 'add', 'byte ptr [rax], al'), (46, 2, 'add', 'byte ptr [rax], al'), (48, 2, 'add', 'byte ptr [rax], al'), (50, 2, 'add', 'byte ptr [rax], al'), (52, 3, 'add', 'byte ptr [rax], dil'), (55, 6, 'add', 'byte ptr [rip + 0x1f004000], cl'), (61, 2, 'add', 'byte ptr [rsi], bl'), (63, 2, 'add', 'byte ptr [rsi], al'), (65, 2, 'add', 'byte ptr [rax], al'), (67, 3, 'add', 'byte ptr [rax + rax], al'), (70, 2, 'add', 'byte ptr [rax], al'), (72, 3, 'add', 'byte ptr [rax], al'), (75, 2, 'add', 'byte ptr [rax], al'), (77, 2, 'add', 'byte ptr [rax], al'), (79, 3, 'add', 'byte ptr [rax], al'), (82, 2, 'add', 'byte ptr [rax], al'), (84, 2, 'add', 'byte ptr [rax], al'), (86, 2, 'add', 'byte ptr [rax], al'), (88, 3, 'add', 'byte ptr [rax], al'), (91, 2, 'add', 'byte ptr [rax], al'), (93, 2, 'add', 'byte ptr [rax], al'), (95, 2, 'add', 'al, bl'), (97, 2, 'add', 'al, byte ptr [rax]'), (99, 2, 'add', 'byte ptr [rax], al'), (101, 2, 'add', 'byte ptr [rax], al'), (103, 2, 'add', 'al, bl'), (105, 2, 'add', 'al, byte ptr [rax]'), (107, 2, 'add', 'byte ptr [rax], al'), (109, 2, 'add', 'byte ptr [rax], al'), (111, 2, 'add', 'byte ptr [rax], cl'), (113, 2, 'add', 'byte ptr [rax], al'), (115, 2, 'add', 'byte ptr [rax], al'), (117, 2, 'add', 'byte ptr [rax], al'), (119, 2, 'add', 'byte ptr [rbx], al'), (121, 2, 'add', 'byte ptr [rax], al'), (123, 3, 'add', 'byte ptr [rax + rax], al'), (126, 2, 'add', 'byte ptr [rax], al'), (128, 2, 'sbb', 'byte ptr [rbx], al'), (130, 2, 'add', 'byte ptr [rax], al'), (132, 2, 'add', 'byte ptr [rax], al'), (134, 2, 'add', 'byte ptr [rax], al'), (136, 2, 'sbb', 'byte ptr [rbx], al'), (138, 2, 'add', 'byte ptr [rax], al'), (140, 2, 'add', 'byte ptr [rax], al'), (142, 2, 'add', 'byte ptr [rax], al'), (144, 2, 'sbb', 'byte ptr [rbx], al'), (146, 2, 'add', 'byte ptr [rax], al'), (148, 2, 'add', 'byte ptr [rax], al'), (150, 2, 'add', 'byte ptr [rax], al'), (152, 2, 'sbb', 'al, 0'), (154, 2, 'add', 'byte ptr [rax], al'), (156, 2, 'add', 'byte ptr [rax], al'), (158, 2, 'add', 'byte ptr [rax], al'), (160, 2, 'sbb', 'al, 0'), (162, 2, 'add', 'byte ptr [rax], al'), (164, 2, 'add', 'byte ptr [rax], al'), (166, 2, 'add', 'byte ptr [rax], al'), (168, 2, 'add', 'dword ptr [rax], eax'), (170, 2, 'add', 'byte ptr [rax], al'), (172, 2, 'add', 'byte ptr [rax], al'), (174, 2, 'add', 'byte ptr [rax], al'), (176, 2, 'add', 'dword ptr [rax], eax'), (178, 2, 'add', 'byte ptr [rax], al'), (180, 2, 'add', 'al, 0'), (182, 2, 'add', 'byte ptr [rax], al'), (184, 2, 'add', 'byte ptr [rax], al'), (186, 2, 'add', 'byte ptr [rax], al'), (188, 2, 'add', 'byte ptr [rax], al'), (190, 2, 'add', 'byte ptr [rax], al'), (192, 2, 'add', 'byte ptr [rax], al'), (194, 2, 'add', 'byte ptr [rax], al'), (196, 2, 'add', 'byte ptr [rax], al'), (198, 2, 'add', 'byte ptr [rax], al'), (200, 2, 'add', 'byte ptr [rax], al'), (202, 2, 'add', 'byte ptr [rax], al'), (204, 2, 'add', 'byte ptr [rax], al'), (206, 2, 'add', 'byte ptr [rax], al'), (208, 1, 'push', 'rax'), (209, 1, 'nop', ''), (210, 2, 'add', 'byte ptr [rax], al'), (212, 2, 'add', 'byte ptr [rax], al'), (214, 2, 'add', 'byte ptr [rax], al'), (216, 1, 'push', 'rax'), (217, 1, 'nop', ''), (218, 2, 'add', 'byte ptr [rax], al'), (220, 2, 'add', 'byte ptr [rax], al'), (222, 2, 'add', 'byte ptr [rax], al'), (224, 2, 'add', 'byte ptr [rax], dl'), (226, 2, 'add', 'byte ptr [rax], al'), (228, 2, 'add', 'byte ptr [rax], al'), (230, 2, 'add', 'byte ptr [rax], al'), (232, 2, 'add', 'dword ptr [rax], eax'), (234, 2, 'add', 'byte ptr [rax], al'), (236, 5, 'add', 'eax, 0'), (241, 9, 'movabs', 'al, byte ptr [0xa000000000000000]'), (250, 2, 'add', 'byte ptr [rax], al'), (252, 2, 'add', 'byte ptr [rax], al'), (254, 2, 'add', 'byte ptr [rax], al'), (256, 6, 'add', 'byte ptr [rax], ah'), (262, 2, 'add', 'byte ptr [rax], al'), (264, 1, 'push', 'rcx')]
Linear Disassembly byte count: 265
Recursive Disassembly instructions: [(0, 2, 'jg', '0x47'), (2, 4, 'add', 'r8b, byte ptr [rcx]'), (6, 2, 'add', 'dword ptr [rax], eax'), (71, 3, 'add', 'byte ptr [rax], al')]
Recursive Disassembly byte count: 11
```
